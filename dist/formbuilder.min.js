!function(){"use strict";var e=function(){var e=this;return this.elements={},this.ElementMock=function(e){var t=this;return this.id=1,this.name=e.name,this.form=e.form,this.placeholder=e.placeholder,this.value=e.value,this.label=e.label,this.disabled=e.disabled||!1,this.error=e.error||null,this.type=e.type,this.wrapClass=e.wrap_class||"",this.elementClass=e.element_class||"",this.labelClass=e.label_class||"",this.displayError=function(){if(null!==t.error&&void 0!==t.error){var e=document.createElement("span");e.className="error",e.innerHTML=t.error,t.html.appendChild(e)}},this},this.getForm=function(t){return e.configIsValid(t)?new e.Form(t.elements,t.form):void 0},this.configIsValid=function(e){if(void 0===e)throw"config must be set";if(void 0===e.elements)throw"elements must be set";return!0},this.register=function(t,n){void 0===e.elements[t]&&(e.elements[t]=n)},this.setForm=function(t){e.Form=t},{getForm:this.getForm,register:this.register,ElementMock:this.ElementMock,setForm:this.setForm,elements:this.elements}};window.FormBuilder=new e}(),function(){"use strict";var e=function(e,t){var n=this;return this.id=1,this.name=t.name||"form-"+this.id,this.config=t||{},this.formClass=t.form_class||"",this.method=t.method||"POST",this.errors={},this.listeners={submit:[],validate:[]},this.on=function(e,t){n.listeners[e]&&n.listeners[e].push(t)},this.dispatch=function(e,t){if("string"!=typeof arguments[0])throw"Invalid event name";var r,s=n.listeners[arguments[0]],l=[];if(Array.prototype.push.apply(l,arguments),l.shift(),s)for(r in s)s[r].apply(null,l)},this.submit=function(){var e,t,r,s={};for(e in n.elements)r=n.elements[e],"function"==typeof r.getData&&(t=r.getData(),null!==t&&(s[e]=t));n.dispatch("validate",s,n),0===Object.keys(n.errors).length?n.listeners.submit.length>0?n.dispatch("submit",s):n.html.submit():n.displayErrors()},this.displayErrors=function(){var e,t,r=n.errors;for(e in r)t=n.elements[e],void 0!==t&&(t.error=r[e],t.displayError())},this.addError=function(e,t){void 0===n.errors[e]&&(n.errors[e]={}),n.errors[e]=t},this.computeElements=function(){var r,s,l;n.elements={};for(r in e)s=e[r],l=FormBuilder.elements[s.type],void 0!==l&&(s.name=r,s.form=n,n.elements[r]=new l(s));n.elements.submit=new FormBuilder.elements.submit({form:n,elementClass:t.submit_class})},this.trigger=function(e,t){n.listeners[e]&&"function"==typeof n[e]&&n[e](t)},this.renderElements=function(e){var t,r,s,l;for(t in n.elements)r=n.elements[t],s=document.createElement("div"),s.className="element_"+t+" "+r.wrapClass,l=r.render(s),void 0!==l&&s.appendChild(l),r.html=s,"submit"!==t&&r.displayError(),e.appendChild(s)},this.render=function(e){if(!e)throw"An DOM node must be passed to render function arguments";var t=document.createElement("form");return n.formClass&&(t.className=n.formClass),t.method=n.method,t.id="form_"+n.id,n.renderElements(t),n.html=t,e.appendChild(t)},this.init=function(){n.computeElements()}(),{id:this.id,name:this.name,elements:this.elements,method:this.method,render:this.render,on:this.on}};FormBuilder.setForm(e)}(),function(){"use strict";FormBuilder.register("checkbox",function(e){var t={};return t=new FormBuilder.ElementMock(e),t.isScalar=!1,/number|string/.test(typeof e.options)?(t.options=[e.options],t.isScalar=!0):"object"==typeof e.options?t.options=e.options:t.options=[],/number|string/.test(typeof e.checked)?t.checked=[e.checked]:"object"==typeof e.checked?t.checked=e.checked:t.checked=[],t.render=function(n){var r,s,l,i,a;t.options.length>1&&(t.name=t.name+"[]");for(r in t.options)s=t.options[r],l=document.createElement("div"),i=document.createElement("input"),a=document.createElement("label"),e.sub_wrap_class&&(l.className=e.sub_wrap_class),t.labelClass&&(a.className=t.labelClass),i.type="checkbox",i.name=t.name,i.value=r,-1!==t.checked.indexOf(r)&&(i.checked="checked"),a.appendChild(i),a.innerHTML=a.innerHTML+" "+s,l.appendChild(a),n.appendChild(l)},t.getData=function(){var e,n,r=t.html.getElementsByTagName("input"),s=[];for(e=0;e<r.length;e++)if(n=r[e],!0===n.checked){if(!0===t.isScalar)return n.value;s.push(n.value)}return s.length>0?s:null},t})}(),function(){"use strict";FormBuilder.register("hidden",function(e){var t={};return t=new FormBuilder.ElementMock(e),t.render=function(){var e=document.createElement("input");return e.type="hidden",e.name=t.name,void 0!==t.value&&null!==t.value&&(e.value=t.value),e},t.getData=function(){return t.html.getElementsByTagName("input")[0].value},t})}(),function(){"use strict";FormBuilder.register("radio",function(e){var t={};return t=new FormBuilder.ElementMock(e),/number|string/.test(typeof e.options)?t.options=[e.options]:"object"==typeof e.options?t.options=e.options:t.options=[],/number|string/.test(typeof e.checked)?t.checked=[e.checked]:"object"==typeof e.checked?t.checked=e.checked:t.checked=[],t.render=function(n){var r,s,l,i,a;for(r in t.options)s=t.options[r],l=document.createElement("div"),i=document.createElement("input"),a=document.createElement("label"),e.sub_wrap_class&&(l.className=e.sub_wrap_class),t.labelClass&&(a.className=t.labelClass),i.type="radio",i.name=t.name,i.value=r,-1!==t.checked.indexOf(r)&&(i.checked="checked"),a.appendChild(i),a.innerHTML=a.innerHTML+" "+s,l.appendChild(a),n.appendChild(l)},t.getData=function(){var e,n,r=t.html.getElementsByTagName("input");for(e=0;e<r.length;e++)if(n=r[e],!0===n.checked)return n.value;return null},t})}(),function(){"use strict";FormBuilder.register("select",function(e){var t={};return t=new FormBuilder.ElementMock(e),t.options="object"==typeof e.options?e.options:[],t.multiple=e.multiple||!1,/number|string/.test(typeof e.selected)?t.selected=[e.selected]:"object"==typeof e.selected?t.selected=e.selected:t.selected=[],t.render=function(e){var n,r=document.createElement("select");if(r.name=t.name,r.disabled=t.disabled,t.label){var s=document.createElement("label");t.labelClass&&(s.className=t.labelClass),s.innerHTML=t.label,e.appendChild(s)}!0===t.multiple&&(r.multiple=!0,r.name=r.name+"[]"),t.elementClass&&(r.className=t.elementClass);for(n in t.options){var l=document.createElement("option");l.value=n,l.text=t.options[n],-1!==t.selected.indexOf(n)&&(l.selected=!0),r.add(l)}return r},t.getData=function(){var e,n,r=t.html.getElementsByTagName("option"),s=[];for(e=0;e<r.length;e++)if(n=r[e],!0===n.selected){if(!0!==t.multiple)return n.value;s.push(n.value)}return s.length>0?s:null},t})}(),function(){"use strict";FormBuilder.register("submit",function(e){var t=this;this.form=e.form,this.elementClass=e.elementClass,this.render=function(){var e=document.createElement("input");return e.type="submit",e.value="Submit",t.elementClass&&(e.className=t.elementClass),e.onclick=function(){return t.form.trigger("submit"),!1},e}})}(),function(){"use strict";FormBuilder.register("text",function(e){var t={};return t=new FormBuilder.ElementMock(e),t.render=function(e){var n=document.createElement("input");if(n.type="text",n.name=t.name,n.disabled=t.disabled,void 0!==t.placeholder&&(n.placeholder=t.placeholder),void 0!==t.value&&null!==t.value&&(n.value=t.value),t.elementClass&&(n.className=t.elementClass),t.label){var r=document.createElement("label");t.labelClass&&(r.className=t.labelClass),r.innerHTML=t.label,e.appendChild(r)}return n},t.getData=function(){return t.html.getElementsByTagName("input")[0].value},t})}(),function(){"use strict";FormBuilder.register("textarea",function(e){var t={};return t=new FormBuilder.ElementMock(e),t.render=function(n){var r=document.createElement("textarea");if(r.name=t.name,r.disabled=t.disabled,r.cols=e.cols||20,r.rows=e.rows||2,void 0!==t.placeholder&&(r.placeholder=t.placeholder),t.label){var s=document.createElement("label");t.labelClass&&(s.className=t.labelClass),s.innerHTML=t.label,n.appendChild(s)}return void 0!==t.value&&null!==t.value&&(r.value=t.value),t.elementClass&&(r.className=t.elementClass),r},t.getData=function(){return t.html.getElementsByTagName("textarea")[0].value},t})}();